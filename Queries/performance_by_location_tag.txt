#Query to find performance by location tag used

SELECT
 location,
 SUM(likes_count) as total_likes,
 AVG(likes_count) as avg_likes,
 SUM(comments_count) as total_comments,
 AVG(comments_count) as avg_comments
FROM
(SELECT
 name as location,
 m.likes_count,
 m.comments_count
FROM
 public.instagram_media_location l
LEFT JOIN 
 public.instagram_media m
ON l.instagram_media_id = m.id
) as t
GROUP BY
1